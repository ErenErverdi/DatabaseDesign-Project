CREATE TABLE UNIVERSITY (
	UNIVERSITY_ID INT IDENTITY(1,1) PRIMARY KEY,
	UNIVERSITY_NAME VARCHAR(50) NOT NULL
)

CREATE TABLE INSTITUTE (
	INSTITUTE_ID INT IDENTITY(1,1) PRIMARY KEY,
	UNIVERSITY_ID INT NOT NULL,
	INSTITUTE_NAME VARCHAR(50) NOT NULL,
	FOREIGN KEY (UNIVERSITY_ID) REFERENCES UNIVERSITY(UNIVERSITY_ID)
)

CREATE TABLE [LANGUAGE] (
	LANGUAGE_ID INT IDENTITY(1,1) PRIMARY KEY,
	LANGUAGE_NAME VARCHAR(50) NOT NULL
)
CREATE TABLE PERSON (
	PERSON_ID INT IDENTITY(1,1) PRIMARY KEY,
	PERSON_NAME VARCHAR(50) NOT NULL,
	PERSON_SURNAME VARCHAR(50) NOT NULL
)
CREATE TABLE [TYPE] (
	[TYPE_ID] INT IDENTITY(1,1) PRIMARY KEY,
	[TYPE_NAME] VARCHAR(50) NOT NULL
)

CREATE TABLE KEYWORD (
	KEYWORD_ID INT IDENTITY(1,1) PRIMARY KEY,
	KEYWORD_NAME VARCHAR(50) NOT NULL
)

CREATE TABLE TOPIC (
	TOPIC_ID INT IDENTITY(1,1) PRIMARY KEY,
	TOPIC_NAME VARCHAR(50) NOT NULL,
)
CREATE TABLE THESIS (
	THESIS_ID INT IDENTITY(1,1) CHECK(THESIS_ID BETWEEN 1 AND 9999999) PRIMARY KEY,
	TITLE VARCHAR(500) NOT NULL,
	ABSTRACT VARCHAR(5000) NOT NULL,
	[YEAR] INT NOT NULL,
	NUM_OF_PAGES INT NOT NULL,
	SUB_DATE DATE NOT NULL,
	[TYPE_ID] INT NOT NULL,
	INSTITUTE_ID INT NOT NULL,
	LANGUAGE_ID INT NOT NULL,
	FOREIGN KEY ([TYPE_ID]) REFERENCES [TYPE]([TYPE_ID]),
	FOREIGN KEY (INSTITUTE_ID) REFERENCES INSTITUTE(INSTITUTE_ID),
	FOREIGN KEY (LANGUAGE_ID) REFERENCES [LANGUAGE](LANGUAGE_ID),
)
CREATE TABLE THESIS_KEYWORD (
	KEYWORD_ID INT NOT NULL,
	THESIS_ID INT NOT NULL,
	PRIMARY KEY (KEYWORD_ID, THESIS_ID),
	FOREIGN KEY (KEYWORD_ID) REFERENCES KEYWORD(KEYWORD_ID),
	FOREIGN KEY (THESIS_ID) REFERENCES THESIS(THESIS_ID)
)
CREATE TABLE THESIS_TOPIC (
	TOPIC_ID INT NOT NULL,
	THESIS_ID INT NOT NULL,
	PRIMARY KEY (TOPIC_ID, THESIS_ID),
	FOREIGN KEY (TOPIC_ID) REFERENCES TOPIC(TOPIC_ID),
	FOREIGN KEY (THESIS_ID) REFERENCES THESIS(THESIS_ID)
)
CREATE TABLE THESIS_PERSON (
	PERSON_ID INT NOT NULL,
	THESIS_ID INT NOT NULL,
	PERSON_ROLE VARCHAR(50),
	CONSTRAINT CK_Person_Role CHECK(PERSON_ROLE IN ('Author','Supervisor','CoSupervisor'),
	PRIMARY KEY (PERSON_ID, THESIS_ID),
	FOREIGN KEY (PERSON_ID) REFERENCES PERSON(PERSON_ID),
	FOREIGN KEY (THESIS_ID) REFERENCES THESIS(THESIS_ID)
)
